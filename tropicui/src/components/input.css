/*
Input component styles.

@description Provides a flexible, customizable input component with various states, sizes, and styles for form inputs with consistent styling. Supports input groups with prefixes, suffixes, and buttons.

@layer components - Applies styles at the component layer of the CSS cascade.

@property {string} --input-bg - Background color of the input
@property {string} --input-border - Border color of the input
@property {string} --input-focus - Outline color when input is focused
@property {string} --input-text - Text color of the input
@property {string} --input-label - Color of labels and other non-input elements within input groups
@property {string} --input-size - Controls the overall size of the input
@property {string} --input-gap - Spacing between elements within input groups
@property {string} --input-color - Accent color that affects border and outline
@property {string} --btn-radius - Overrides the default button radius
*/
@layer components {
    .input {
        /* modifiers */
        --input-bg: color-mix(in oklab, var(--input-color) 15%, transparent);
        /* --input-bg: var(--color-base); */
        --input-border: var(--input-color, var(--color-base-border));
        --input-focus: color-mix(in oklab, var(--input-color, var(--color-accent)) 40%, transparent);
        --input-text: var(--color-base-foreground);
        --input-label: var(--color-base-dense);
        --input-size: --spacing(10);
        --input-gap: calc(var(--input-size) * 0.4);
        --btn-radius: none;

        /* layout */
        overflow: hidden;

        /* dimensions */
        block-size: var(--input-size);

        /* colors */
        border: 1px solid var(--input-border);
        border-radius: var(--radius-control);
        outline: 0px solid var(--input-focus);
        background-color: var(--input-bg, var(--color-base));
        box-shadow: var(--shadow-low);

        /* input field */
        &:is(input), input {
            /* layout */
            overflow: hidden;
            inline-size: 100%;

            /* dimensions */
            padding-inline: var(--input-gap);

            /* typography */
            color: var(--input-text);
            font-size: calc(var(--input-size) * 0.4);
            line-height: 1;

            &::placeholder {
                font-style: italic;
            }

            &:read-only:not(:disabled, [disabled]) {
                background-color: var(--color-base-border);
            }

            &:is([type="file"]) {
                padding-inline-start: 0px;
                &:not(:disabled, [disabled]) {
                    background-color: var(--input-bg);
                }
            
                &::file-selector-button {
                    block-size: 100%;
                    min-inline-size: var(--input-size);
                    padding-inline: var(--input-gap);
                    margin-inline-end: var(--input-gap);

                    /* color */
                    background-color: var(--input-bg);
                    border-inline-end: 1px solid var(--color-base-border);
                }

                @media (hover: hover) {
                    &::file-selector-button:hover {
                        background-color: color-mix(in oklab, var(--input-bg), var(--color-black) 6%);
                    }
                }

                &::file-selector-button:active {
                    background-color: color-mix(in oklab, var(--input-bg), var(--color-black) 12%);
                }
            }
        }

        /* disabled */
        &:is(:disabled, [disabled]),
        &:has(:disabled, [disabled]) {
            cursor: not-allowed;
            /* colors */
            background-color: var(--color-base-border);
            box-shadow: none;
        }

        /* focus */
        &:not(.input-nofocus):focus-visible,
        &:not(.input-nofocus):has(:focus-visible) {
            outline-width: 3px;
            border-color: var(--input-color, var(--color-accent));
            background-color: color-mix(in oklab, var(--input-bg), transparent 80%);
        }

        /* validation */
        &.input-validate:user-invalid,
        &.input-validate:has(:user-invalid),
        &.input-invalid,
        &:has(.input-invalid) {
            --input-color: var(--color-danger);

            outline-width: 3px;
            outline-style: solid;
        }

        /* input group */
        &:not(input) {
            display: flex;
            align-items: center;

            > input {
                flex: 1;
                outline-width: 0;
                block-size: 100%;
            }

            /* label */
            > :where(:not(input, .btn)) {
                padding-inline: var(--input-gap) --spacing(0);

                /* typography */
                color: var(--input-label);
                font-size: calc(var(--input-size) * 0.4);
                line-height: 1;

                &:last-child {
                    padding-inline: --spacing(0) var(--input-gap);
                }
            }

            /* button */
            > .btn {
                block-size: 100%;
                min-inline-size: var(--input-size);

                &:has(~ input) {
                    border-inline-end: 1px solid var(--color-base-border);
                }
                &:not(:has(~ input)) {
                    border-inline-start: 1px solid var(--color-base-border);
                }
            }
        }
        
        :where(svg, img) {
            block-size: 1.25em;

            .btn & {
                width: auto;
                min-width: auto;
            }
        }

        &:has(.input-prefix, .input-suffix) {
            .input-prefix, .input-suffix {
                block-size: 100%;
                min-inline-size: var(--input-size);
                align-content: center;
                justify-items: center;
                text-align: center;
                padding-inline: --spacing(2);
                background-color: var(--color-base-airy);
            }

            .input-prefix {
                border-inline-end: 1px solid var(--color-base-border);
            }
    
            .input-suffix {
                border-inline-start: 1px solid var(--color-base-border);
            }
        }
    }

    /* variations */
    .input-clear {
        /* colors */
        border: none;
        box-shadow: none;
        background: none;
    }

    .input-solid {
        /* colors */
        border: none;
        box-shadow: none;
        background-color: var(--color-base-airy);
    }

    .input.input-outline,
    .input.input-outline-bold {
        /* colors */
        background: none;
        box-shadow: none;
    }

    .input-outline-bold {
        border-width: 2px;
    }

    /* colors */
    .input-primary {
        --input-color: var(--color-primary);
    }
    .input-accent {
        --input-color: var(--color-accent);
    }
    .input-success {
        --input-color: var(--color-success);
    }
    .input-warning {
        --input-color: var(--color-warning);
    }
    .input-danger {
        --input-color: var(--color-danger);
    }

    /* sizes */
    .input-xs {
        --input-size: --spacing(7);
    }

    .input-sm {
        --input-size: --spacing(8);
    }

    .input-lg {
        --input-size: --spacing(10);
    }

    .input-xl {
        --input-size: --spacing(12);
    }

    .input-2xl {
        --input-size: --spacing(14);
    }
}